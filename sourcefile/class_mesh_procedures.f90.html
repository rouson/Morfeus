<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A toolkit for constructing parallel PDE solvers using finite volume and finite difference methods.">
    
    <meta name="author" content="Guide Star Engineering, LLC" >
    <link rel="icon" href="../favicon.png">

    <title>class_mesh_procedures.F90 &ndash; Morfeus Framework</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    
    <link href="../css/user.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Morfeus Framework </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Developer Documentation</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>class_mesh_procedures.F90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.3% of total for source files.">337 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/class_mesh_procedures.F90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">class_mesh_procedures.F90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 








<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#submods-0">Submodules</a></h3></div>
  <div id="submods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/class_mesh_procedures.html">class_mesh_procedures</a>
      
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/class_mesh_procedures.f90.html#src">class_mesh_procedures.F90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: sourcefile~~class_mesh_procedures.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileclass_mesh_proceduresf90EfferentGraph" width="641pt" height="270pt"
 viewBox="0.00 0.00 641.00 269.53" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph" class="graph" transform="scale(1.99 1.99) rotate(0) translate(4 533.44)">
<title>sourcefile~~class_mesh_procedures.f90~~EfferentGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-533.44 1274.16,-533.44 1274.16,4 -4,4"/>
<!-- sourcefile~class_mesh_procedures.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~class_mesh_procedures.f90</title>
<polygon fill="none" stroke="black" points="1270.07,-392.26 1123.43,-392.26 1123.43,-370.24 1270.07,-370.24 1270.07,-392.26"/>
<text text-anchor="middle" x="1196.75" y="-378.1" font-family="Helvetica,sans-Serif" font-size="10.50">class_mesh_procedures.F90</text>
</g>
<!-- sourcefile~class_keytable.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~class_keytable.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/class_keytable.f90.html" xlink:title="class_keytable.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="916.07,-376.26 817.3,-376.26 817.3,-354.24 916.07,-354.24 916.07,-376.26"/>
<text text-anchor="middle" x="866.69" y="-362.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_keytable.f90</text>
</a>
</g>
</g>
<!-- sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_keytable.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_keytable.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1025.17,-362.25C992.73,-356.75 956,-357.08 926.17,-358.98"/>
<polygon fill="#ff0000" stroke="#ff0000" points="925.66,-355.51 915.93,-359.71 926.15,-362.49 925.66,-355.51"/>
</g>
<!-- sourcefile~class_psblas.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~class_psblas.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/class_psblas.f90.html" xlink:title="class_psblas.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="355.88,-295.26 266.62,-295.26 266.62,-273.24 355.88,-273.24 355.88,-295.26"/>
<text text-anchor="middle" x="311.25" y="-281.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_psblas.f90</text>
</a>
</g>
</g>
<!-- sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_psblas.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_psblas.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1025.17,-481.25C890.1,-517.92 852.37,-511.5 712.68,-520.25"/>
</g>
<!-- sourcefile~tools_output_basics.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~tools_output_basics.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/tools_output_basics.f90.html" xlink:title="tools_output_basics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1087.5,-453.26 964.85,-453.26 964.85,-431.24 1087.5,-431.24 1087.5,-453.26"/>
<text text-anchor="middle" x="1026.17" y="-439.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tools_output_basics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~tools_output_basics.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~tools_output_basics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1166.35,-392.26C1144.57,-400.37 1114.15,-411.63 1087.34,-421.25 1081.32,-423.41 1074.96,-425.66 1068.72,-427.86"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1067.34,-424.63 1059.06,-431.24 1069.65,-431.24 1067.34,-424.63"/>
</g>
<!-- sourcefile~class_surface.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~class_surface.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/class_surface.f90.html" xlink:title="class_surface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="913.39,-298.26 819.98,-298.26 819.98,-276.24 913.39,-276.24 913.39,-298.26"/>
<text text-anchor="middle" x="866.69" y="-284.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_surface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_surface.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_surface.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1025.17,-362.25C974.3,-353.62 921.39,-323.26 891.68,-303.91"/>
<polygon fill="#ff0000" stroke="#ff0000" points="893.5,-300.92 883.24,-298.3 889.63,-306.75 893.5,-300.92"/>
</g>
<!-- sourcefile~class_connectivity.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~class_connectivity.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/class_connectivity.f90.html" xlink:title="class_connectivity.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="768.54,-451.26 654.82,-451.26 654.82,-429.24 768.54,-429.24 768.54,-451.26"/>
<text text-anchor="middle" x="711.68" y="-437.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_connectivity.f90</text>
</a>
</g>
</g>
<!-- sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_connectivity.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_connectivity.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1183.66,-392.47C1164.55,-409.67 1125.6,-442.63 1087.34,-462.25 1062.39,-475.04 1054.24,-473.9 1027.17,-481.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1025.17,-481.25C955.58,-500.14 939.79,-442.56 867.69,-442.25"/>
</g>
<!-- sourcefile~tools_mesh.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~tools_mesh.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/tools_mesh.f90.html" xlink:title="tools_mesh.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="908.39,-492.26 824.98,-492.26 824.98,-470.24 908.39,-470.24 908.39,-492.26"/>
<text text-anchor="middle" x="866.69" y="-478.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tools_mesh.f90</text>
</a>
</g>
</g>
<!-- sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~tools_mesh.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~tools_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1025.17,-481.25C990.56,-490.65 950.07,-490.41 918.82,-487.95"/>
<polygon fill="#ff0000" stroke="#ff0000" points="918.86,-484.44 908.59,-487.04 918.24,-491.42 918.86,-484.44"/>
</g>
<!-- sourcefile~class_vertex.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~class_vertex.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/class_vertex.f90.html" xlink:title="class_vertex.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="611.05,-217.26 523.31,-217.26 523.31,-195.24 611.05,-195.24 611.05,-217.26"/>
<text text-anchor="middle" x="567.18" y="-203.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_vertex.f90</text>
</a>
</g>
</g>
<!-- sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_vertex.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_vertex.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1025.17,-169.25C972.01,-123.79 782.52,-203.23 712.68,-207.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M710.68,-207.25C681.24,-208.8 648.32,-208.7 621.55,-208.13"/>
<polygon fill="#ff0000" stroke="#ff0000" points="621.32,-204.63 611.24,-207.89 621.15,-211.63 621.32,-204.63"/>
</g>
<!-- sourcefile~class_cell.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~class_cell.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/class_cell.f90.html" xlink:title="class_cell.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="905.71,-63.26 827.66,-63.26 827.66,-41.24 905.71,-41.24 905.71,-63.26"/>
<text text-anchor="middle" x="866.69" y="-49.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_cell.F90</text>
</a>
</g>
</g>
<!-- sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_cell.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_cell.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1025.17,-169.25C980.22,-130.81 978.64,-109.43 929.01,-77.25 923.31,-73.55 916.97,-70.23 910.59,-67.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="911.85,-64.04 901.28,-63.31 909.09,-70.47 911.85,-64.04"/>
</g>
<!-- sourcefile~class_least_squares.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~class_least_squares.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node10"><a xlink:href=".././sourcefile/class_least_squares.f90.html" xlink:title="class_least_squares.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="928.84,-257.26 804.54,-257.26 804.54,-235.24 928.84,-235.24 928.84,-257.26"/>
<text text-anchor="middle" x="866.69" y="-243.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_least_squares.f90</text>
</a>
</g>
</g>
<!-- sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_least_squares.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_least_squares.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1123.31,-374.87C1093.44,-371.78 1058.53,-367.57 1027.17,-362.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1025.17,-362.25C965.94,-352.21 980.08,-298.89 929.01,-267.25 925.46,-265.05 921.65,-263.05 917.73,-261.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="919.02,-257.98 908.45,-257.32 916.31,-264.43 919.02,-257.98"/>
</g>
<!-- sourcefile~class_face.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~class_face.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node11"><a xlink:href=".././sourcefile/class_face.f90.html" xlink:title="class_face.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="907.81,-22.26 825.57,-22.26 825.57,-0.24 907.81,-0.24 907.81,-22.26"/>
<text text-anchor="middle" x="866.69" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_face.F90</text>
</a>
</g>
</g>
<!-- sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_face.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_face.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1025.17,-169.25C968.64,-120.9 988.49,-76.94 929.01,-32.25 925.42,-29.55 921.46,-27.19 917.33,-25.11"/>
<polygon fill="#ff0000" stroke="#ff0000" points="918.67,-21.88 908.11,-21.03 915.84,-28.28 918.67,-21.88"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1190.87,-369.88C1177.72,-340.23 1139.02,-259.25 1087.34,-207.25 1065.04,-184.82 1051.21,-189.8 1027.17,-169.25"/>
</g>
<!-- sourcefile~class_mesh.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~class_mesh.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node12"><a xlink:href=".././sourcefile/class_mesh.f90.html" xlink:title="class_mesh.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1070.62,-238.26 981.72,-238.26 981.72,-216.24 1070.62,-216.24 1070.62,-238.26"/>
<text text-anchor="middle" x="1026.17" y="-224.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_mesh.F90</text>
</a>
</g>
</g>
<!-- sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_mesh.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_mesh.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1183.62,-370.17C1154.97,-344 1082.82,-278.08 1047.41,-245.74"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1049.39,-242.8 1039.64,-238.64 1044.66,-247.97 1049.39,-242.8"/>
</g>
<!-- sourcefile~class_vector.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~class_vector.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node13"><a xlink:href=".././sourcefile/class_vector.f90.html" xlink:title="class_vector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="479.5,-295.26 391.91,-295.26 391.91,-273.24 479.5,-273.24 479.5,-295.26"/>
<text text-anchor="middle" x="435.71" y="-281.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_vector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_vector.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~class_vector.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1025.17,-362.25C981.85,-354.9 972.65,-380.1 929.01,-385.25 767.41,-404.31 725.37,-365.3 568.18,-323.25"/>
</g>
<!-- sourcefile~tools_mesh_basics.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~tools_mesh_basics.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node14"><a xlink:href=".././sourcefile/tools_mesh_basics.f90.html" xlink:title="tools_mesh_basics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1085.48,-412.26 966.86,-412.26 966.86,-390.24 1085.48,-390.24 1085.48,-412.26"/>
<text text-anchor="middle" x="1026.17" y="-398.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tools_mesh_basics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~tools_mesh_basics.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~class_mesh_procedures.f90&#45;&gt;sourcefile~tools_mesh_basics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1123.28,-389.85C1114.14,-390.93 1104.81,-392.04 1095.73,-393.12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1095.13,-389.66 1085.61,-394.32 1095.95,-396.61 1095.13,-389.66"/>
</g>
<!-- sourcefile~class_stopwatch.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~class_stopwatch.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node15"><a xlink:href=".././sourcefile/class_stopwatch.f90.html" xlink:title="class_stopwatch.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="230.21,-276.26 124.11,-276.26 124.11,-254.24 230.21,-254.24 230.21,-276.26"/>
<text text-anchor="middle" x="177.16" y="-262.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_stopwatch.f90</text>
</a>
</g>
</g>
<!-- sourcefile~class_psblas.f90&#45;&gt;sourcefile~class_stopwatch.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~class_psblas.f90&#45;&gt;sourcefile~class_stopwatch.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M266.27,-277.92C258.07,-276.74 249.35,-275.49 240.72,-274.25"/>
<polygon fill="#ff7500" stroke="#ff7500" points="241.06,-270.76 230.66,-272.8 240.06,-277.69 241.06,-270.76"/>
</g>
<!-- sourcefile~tools_psblas.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~tools_psblas.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node18"><a xlink:href=".././sourcefile/tools_psblas.f90.html" xlink:title="tools_psblas.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="87.83,-295.26 0.06,-295.26 0.06,-273.24 87.83,-273.24 87.83,-295.26"/>
<text text-anchor="middle" x="43.94" y="-281.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tools_psblas.f90</text>
</a>
</g>
</g>
<!-- sourcefile~class_psblas.f90&#45;&gt;sourcefile~tools_psblas.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~class_psblas.f90&#45;&gt;sourcefile~tools_psblas.f90</title>
<path fill="none" stroke="#ff7500" stroke-dasharray="5,2" d="M266.34,-284.9C254.67,-285.04 242.08,-285.18 230.44,-285.25 183.08,-285.55 171.24,-285.55 123.88,-285.25 115.51,-285.2 106.64,-285.11 97.98,-285.01"/>
<polygon fill="#ff7500" stroke="#ff7500" points="98,-281.51 87.96,-284.89 97.92,-288.51 98,-281.51"/>
</g>
<!-- sourcefile~tools_output_basics.f90&#45;&gt;sourcefile~class_connectivity.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~tools_output_basics.f90&#45;&gt;sourcefile~class_connectivity.f90</title>
<path fill="none" stroke="#ffeb00" stroke-dasharray="5,2" d="M964.97,-442.37C935.62,-442.4 899.81,-442.39 867.69,-442.25"/>
</g>
<!-- sourcefile~class_surface.f90&#45;&gt;sourcefile~class_connectivity.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~class_surface.f90&#45;&gt;sourcefile~class_connectivity.f90</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M827.44,-298.27C819.22,-301.83 811.02,-306.42 804.36,-312.25 780.1,-333.5 786.93,-348.89 768.36,-375.25 756.85,-391.59 742.06,-408.71 730.62,-421.27"/>
<polygon fill="#9cff00" stroke="#9cff00" points="727.86,-419.1 723.65,-428.82 733,-423.85 727.86,-419.1"/>
</g>
<!-- sourcefile~class_plane.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~class_plane.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node16"><a xlink:href=".././sourcefile/class_plane.f90.html" xlink:title="class_plane.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="609.65,-373.26 524.71,-373.26 524.71,-351.24 609.65,-351.24 609.65,-373.26"/>
<text text-anchor="middle" x="567.18" y="-359.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_plane.f90</text>
</a>
</g>
</g>
<!-- sourcefile~class_surface.f90&#45;&gt;sourcefile~class_plane.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~class_surface.f90&#45;&gt;sourcefile~class_plane.f90</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M834.82,-298.3C824.88,-302.26 813.96,-307.04 804.36,-312.25 787.24,-321.54 786.55,-330.29 768.36,-337.25 720.27,-355.66 661.38,-361.17 619.96,-362.52"/>
<polygon fill="#9cff00" stroke="#9cff00" points="619.74,-359.03 609.83,-362.78 619.92,-366.03 619.74,-359.03"/>
</g>
<!-- sourcefile~class_cylinder.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~class_cylinder.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node19"><a xlink:href=".././sourcefile/class_cylinder.f90.html" xlink:title="class_cylinder.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="759.06,-295.26 664.3,-295.26 664.3,-273.24 759.06,-273.24 759.06,-295.26"/>
<text text-anchor="middle" x="711.68" y="-281.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">class_cylinder.f90</text>
</a>
</g>
</g>
<!-- sourcefile~class_surface.f90&#45;&gt;sourcefile~class_cylinder.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~class_surface.f90&#45;&gt;sourcefile~class_cylinder.f90</title>
<path fill="none" stroke="#9cff00" stroke-dasharray="5,2" d="M819.78,-286.35C803.89,-286.04 785.89,-285.69 769.24,-285.36"/>
<polygon fill="#9cff00" stroke="#9cff00" points="769.15,-281.86 759.08,-285.16 769.01,-288.86 769.15,-281.86"/>
</g>
<!-- sourcefile~class_connectivity.f90&#45;&gt;sourcefile~class_psblas.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~class_connectivity.f90&#45;&gt;sourcefile~class_psblas.f90</title>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M698.54,-451.38C675.33,-471.58 622.16,-512.92 568.18,-520.25"/>
<path fill="none" stroke="#27ff00" stroke-dasharray="5,2" d="M566.18,-520.25C509.16,-528 492.13,-535.72 436.71,-520.25"/>
</g>
<!-- sourcefile~tools_mesh.f90&#45;&gt;sourcefile~class_psblas.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~tools_mesh.f90&#45;&gt;sourcefile~class_psblas.f90</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M836.03,-492.33C805.58,-502.87 756.59,-517.5 712.68,-520.25"/>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M710.68,-520.25C647.47,-524.21 630.94,-511.72 568.18,-520.25"/>
</g>
<!-- sourcefile~tools_mesh.f90&#45;&gt;sourcefile~class_connectivity.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~tools_mesh.f90&#45;&gt;sourcefile~class_connectivity.f90</title>
<path fill="none" stroke="#00ff4e" stroke-dasharray="5,2" d="M824.68,-470.26C805.9,-465.23 783.46,-459.22 763.61,-453.9"/>
<polygon fill="#00ff4e" stroke="#00ff4e" points="764.36,-450.48 753.8,-451.27 762.55,-457.24 764.36,-450.48"/>
</g>
<!-- sourcefile~class_vertex.f90&#45;&gt;sourcefile~class_psblas.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~class_vertex.f90&#45;&gt;sourcefile~class_psblas.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M529.94,-217.28C503.99,-225.15 468.23,-235.94 436.71,-245.25"/>
</g>
<!-- sourcefile~class_vertex.f90&#45;&gt;sourcefile~class_vector.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~class_vertex.f90&#45;&gt;sourcefile~class_vector.f90</title>
<path fill="none" stroke="#00ffc4" stroke-dasharray="5,2" d="M548.28,-217.31C530.76,-228.09 503.3,-244.92 479.36,-259.25 474.57,-262.11 469.46,-265.14 464.51,-268.05"/>
<polygon fill="#00ffc4" stroke="#00ffc4" points="462.72,-265.04 455.86,-273.12 466.26,-271.08 462.72,-265.04"/>
</g>
<!-- sourcefile~class_cell.f90&#45;&gt;sourcefile~class_psblas.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~class_cell.f90&#45;&gt;sourcefile~class_psblas.f90</title>
<path fill="none" stroke="#00c4ff" stroke-dasharray="5,2" d="M830.22,-63.3C799.45,-72.39 753.57,-84.8 712.68,-91.25"/>
</g>
<!-- sourcefile~class_least_squares.f90&#45;&gt;sourcefile~class_psblas.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~class_least_squares.f90&#45;&gt;sourcefile~class_psblas.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M804.36,-241.82C702.66,-235.2 503.67,-225.47 436.71,-245.25"/>
</g>
<!-- sourcefile~class_least_squares.f90&#45;&gt;sourcefile~class_connectivity.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~class_least_squares.f90&#45;&gt;sourcefile~class_connectivity.f90</title>
<path fill="none" stroke="#004eff" stroke-dasharray="5,2" d="M820.3,-257.27C814.54,-259.92 809.04,-263.2 804.36,-267.25 777.9,-290.13 784.68,-306.31 768.36,-337.25 753.05,-366.28 734.91,-399.65 723.6,-420.35"/>
<polygon fill="#004eff" stroke="#004eff" points="720.5,-418.71 718.77,-429.16 726.64,-422.07 720.5,-418.71"/>
</g>
<!-- sourcefile~class_face.f90&#45;&gt;sourcefile~class_psblas.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~class_face.f90&#45;&gt;sourcefile~class_psblas.f90</title>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M434.71,-245.25C408.49,-253.3 379.21,-262.61 355.86,-270.12"/>
<polygon fill="#2700ff" stroke="#2700ff" points="354.68,-266.82 346.24,-273.21 356.83,-273.48 354.68,-266.82"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M710.68,-91.25C622.68,-105.12 589.57,-86.98 515.36,-136.25 465.59,-169.29 493.82,-227.72 436.71,-245.25"/>
<path fill="none" stroke="#2700ff" stroke-dasharray="5,2" d="M828.78,-22.27C820.59,-25.16 812.06,-28.52 804.36,-32.25 760.75,-53.36 759.99,-80.79 712.68,-91.25"/>
</g>
<!-- sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_keytable.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_keytable.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M1018.33,-238.42C1004.2,-260.65 969.71,-310.8 929.01,-340.25 923.88,-343.97 918.11,-347.24 912.22,-350.09"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="910.65,-346.96 902.94,-354.23 913.5,-353.35 910.65,-346.96"/>
</g>
<!-- sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_psblas.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_psblas.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M1005.37,-216.19C992.6,-208.3 976.33,-196.72 965.01,-183.25 941.74,-155.55 958.86,-130.68 929.01,-110.25 849.36,-55.74 806.92,-70.41 712.68,-91.25"/>
</g>
<!-- sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_surface.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_surface.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M998.8,-238.41C979.56,-246.43 952.81,-257.36 929.01,-266.25 923.13,-268.45 916.9,-270.68 910.75,-272.84"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="909.53,-269.56 901.22,-276.14 911.82,-276.17 909.53,-269.56"/>
</g>
<!-- sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_connectivity.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_connectivity.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M1014.71,-238.45C998.1,-255.61 963.98,-288.37 929.01,-307.25 878.04,-334.76 853.75,-315 804.36,-345.25 771.72,-365.24 742.65,-399.58 726.39,-421.03"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="723.55,-418.98 720.41,-429.1 729.18,-423.14 723.55,-418.98"/>
</g>
<!-- sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_vertex.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_vertex.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M982.42,-216.17C950.76,-209.35 906.56,-202.69 867.69,-207.25"/>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M865.69,-207.25C798.15,-215.16 780.57,-203.34 712.68,-207.25"/>
</g>
<!-- sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_cell.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_cell.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M1003.91,-216.15C991.04,-208.46 975.2,-197.12 965.01,-183.25 935.56,-143.15 963.13,-113.47 929.01,-77.25 924.97,-72.96 920.09,-69.39 914.87,-66.41"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="916.36,-63.25 905.84,-61.96 913.26,-69.52 916.36,-63.25"/>
</g>
<!-- sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_least_squares.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_least_squares.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M981.72,-232.49C968.48,-234.09 953.56,-235.89 938.98,-237.65"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="938.48,-234.18 928.97,-238.86 939.32,-241.13 938.48,-234.18"/>
</g>
<!-- sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_face.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_face.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M1002.86,-216.12C989.93,-208.56 974.4,-197.37 965.01,-183.25 926.82,-125.8 975.4,-83.32 929.01,-32.25 925.69,-28.59 921.7,-25.57 917.37,-23.07"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="918.64,-19.8 908.11,-18.65 915.63,-26.12 918.64,-19.8"/>
</g>
<!-- sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_vector.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~class_mesh.f90&#45;&gt;sourcefile~class_vector.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M566.18,-323.25C538.06,-315.39 506.71,-305.96 481.9,-298.34"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="482.63,-294.9 472.04,-295.31 480.57,-301.59 482.63,-294.9"/>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M865.69,-207.25C837.35,-210.57 825.82,-207.45 804.36,-226.25 775.64,-251.41 799.51,-282.17 768.36,-304.25 731.9,-330.09 611.21,-335.29 568.18,-323.25"/>
</g>
<!-- sourcefile~grid_interface.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~grid_interface.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node17"><a xlink:href=".././sourcefile/grid_interface.f90.html" xlink:title="grid_interface.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="914.82,-141.26 818.55,-141.26 818.55,-119.24 914.82,-119.24 914.82,-141.26"/>
<text text-anchor="middle" x="866.69" y="-127.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">grid_interface.F90</text>
</a>
</g>
</g>
<!-- sourcefile~class_mesh.f90&#45;&gt;sourcefile~grid_interface.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~class_mesh.f90&#45;&gt;sourcefile~grid_interface.f90</title>
<path fill="none" stroke="#9c00ff" stroke-dasharray="5,2" d="M1007.11,-216.12C979.61,-199.18 927.05,-166.81 894.9,-147.01"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="896.38,-143.81 886.03,-141.55 892.71,-149.77 896.38,-143.81"/>
</g>
<!-- sourcefile~class_vector.f90&#45;&gt;sourcefile~class_psblas.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~class_vector.f90&#45;&gt;sourcefile~class_psblas.f90</title>
<path fill="none" stroke="#ff00eb" stroke-dasharray="5,2" d="M391.88,-284.25C383.64,-284.25 374.91,-284.25 366.37,-284.25"/>
<polygon fill="#ff00eb" stroke="#ff00eb" points="366.09,-280.75 356.09,-284.25 366.09,-287.75 366.09,-280.75"/>
</g>
<!-- sourcefile~tools_mesh_basics.f90&#45;&gt;sourcefile~class_connectivity.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~tools_mesh_basics.f90&#45;&gt;sourcefile~class_connectivity.f90</title>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M991.24,-412.27C952.55,-424.45 891.56,-442.35 867.69,-442.25"/>
<path fill="none" stroke="#ff0075" stroke-dasharray="5,2" d="M865.69,-442.25C837.18,-442.13 805.7,-441.75 778.73,-441.36"/>
<polygon fill="#ff0075" stroke="#ff0075" points="778.69,-437.86 768.64,-441.21 778.58,-444.86 778.69,-437.86"/>
</g>
<!-- sourcefile~class_stopwatch.f90&#45;&gt;sourcefile~tools_psblas.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~class_stopwatch.f90&#45;&gt;sourcefile~tools_psblas.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M123.92,-272.81C115.49,-274.04 106.75,-275.3 98.28,-276.53"/>
<polygon fill="#ff0000" stroke="#ff0000" points="97.54,-273.1 88.14,-277.99 98.54,-280.03 97.54,-273.1"/>
</g>
<!-- sourcefile~class_plane.f90&#45;&gt;sourcefile~class_psblas.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~class_plane.f90&#45;&gt;sourcefile~class_psblas.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M434.71,-520.25C343.39,-494.76 319.78,-358.26 314.01,-305.28"/>
<polygon fill="#cbff00" stroke="#cbff00" points="317.49,-304.93 313.03,-295.32 310.52,-305.61 317.49,-304.93"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M563.32,-373.3C552.51,-412.44 511,-540.99 436.71,-520.25"/>
</g>
<!-- sourcefile~class_plane.f90&#45;&gt;sourcefile~class_vector.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~class_plane.f90&#45;&gt;sourcefile~class_vector.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M542.04,-351.2C533.48,-347.07 523.87,-342.18 515.36,-337.25 496.3,-326.21 475.69,-312.24 460.35,-301.41"/>
<polygon fill="#cbff00" stroke="#cbff00" points="462.15,-298.4 451.98,-295.45 458.09,-304.1 462.15,-298.4"/>
</g>
<!-- sourcefile~object_interface.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~object_interface.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node20"><a xlink:href=".././sourcefile/object_interface.f90.html" xlink:title="object_interface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="618.82,-167.26 515.53,-167.26 515.53,-145.24 618.82,-145.24 618.82,-167.26"/>
<text text-anchor="middle" x="567.18" y="-153.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">object_interface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~grid_interface.f90&#45;&gt;sourcefile~object_interface.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~grid_interface.f90&#45;&gt;sourcefile~object_interface.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M819.91,-141.35C803.72,-144.83 785.32,-148.27 768.36,-150.25 721.82,-155.69 668.8,-157.06 629.03,-157.15"/>
<polygon fill="#00ff66" stroke="#00ff66" points="628.95,-153.65 618.95,-157.14 628.95,-160.65 628.95,-153.65"/>
</g>
<!-- sourcefile~units_interface.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~units_interface.f90</title>
<g id="a_sourcefile~~class_mesh_procedures.f90~~EfferentGraph_node21"><a xlink:href=".././sourcefile/units_interface.f90.html" xlink:title="units_interface.F90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="762.48,-141.26 660.88,-141.26 660.88,-119.24 762.48,-119.24 762.48,-141.26"/>
<text text-anchor="middle" x="711.68" y="-127.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">units_interface.F90</text>
</a>
</g>
</g>
<!-- sourcefile~grid_interface.f90&#45;&gt;sourcefile~units_interface.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~grid_interface.f90&#45;&gt;sourcefile~units_interface.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M818.53,-130.25C804.12,-130.25 788.07,-130.25 772.92,-130.25"/>
<polygon fill="#00ff66" stroke="#00ff66" points="772.6,-126.75 762.6,-130.25 772.6,-133.75 772.6,-126.75"/>
</g>
<!-- sourcefile~class_cylinder.f90&#45;&gt;sourcefile~class_psblas.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~class_cylinder.f90&#45;&gt;sourcefile~class_psblas.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M664.09,-285.48C636.22,-285.83 600.13,-285.6 568.18,-283.25"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M566.18,-283.25C506.37,-278.85 494.22,-228.26 436.71,-245.25"/>
</g>
<!-- sourcefile~class_cylinder.f90&#45;&gt;sourcefile~class_vertex.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~class_cylinder.f90&#45;&gt;sourcefile~class_vertex.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M690.57,-273.24C666.3,-259.96 625.32,-237.53 597.53,-222.31"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="599.11,-219.19 588.65,-217.46 595.74,-225.33 599.11,-219.19"/>
</g>
<!-- sourcefile~class_cylinder.f90&#45;&gt;sourcefile~class_vector.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~class_cylinder.f90&#45;&gt;sourcefile~class_vector.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M566.18,-283.25C541.09,-281.41 513.18,-281.37 489.73,-281.9"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="489.53,-278.41 479.63,-282.18 489.72,-285.41 489.53,-278.41"/>
</g>
<!-- sourcefile~units_interface.f90&#45;&gt;sourcefile~object_interface.f90 -->
<g id="sourcefile~~class_mesh_procedures.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~units_interface.f90&#45;&gt;sourcefile~object_interface.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M660.84,-139.34C650.62,-141.21 639.76,-143.19 629.2,-145.12"/>
<polygon fill="#00ffff" stroke="#00ffff" points="628.41,-141.7 619.2,-146.94 629.66,-148.59 628.41,-141.7"/>
</g>
</g>
</svg>
</div><script>var pansourcefileclass_mesh_proceduresf90EfferentGraph = svgPanZoom('#sourcefileclass_mesh_proceduresf90EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-26.5 182.41,-26.5 182.41,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.16,-22.26 -0.05,-22.26 -0.05,-0.24 65.16,-0.24 65.16,-22.26"/>
<text text-anchor="middle" x="32.55" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="178.26,-22.26 82.84,-22.26 82.84,-0.24 178.26,-0.24 178.26,-22.26"/>
<text text-anchor="middle" x="130.55" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 








<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#submods-1">Submodules</a></h3></div>
  <div id="submods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/class_mesh_procedures.html">class_mesh_procedures</a>
      
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/class_mesh_procedures.f90.html#src">class_mesh_procedures.F90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!     (c) 2019 Guide Star Engineering, LLC</span>
<a name="ln-2"></a><span class="c">!     This Software was developed for the US Nuclear Regulatory Commission (US NRC)</span>
<a name="ln-3"></a><span class="c">!     under contract &quot;Multi-Dimensional Physics Implementation into Fuel Analysis under</span>
<a name="ln-4"></a><span class="c">!     Steady-state and Transients (FAST)&quot;, contract # NRC-HQ-60-17-C-0007</span>
<a name="ln-5"></a><span class="c">!</span>
<a name="ln-6"></a><span class="k">SUBMODULE</span><span class="p">(</span><span class="n">class_mesh</span><span class="p">)</span> <span class="n">class_mesh_procedures</span>
<a name="ln-7"></a>    <span class="k">USE </span><span class="n">psb_base_mod</span>
<a name="ln-8"></a>    <span class="k">USE </span><span class="n">class_psblas</span>
<a name="ln-9"></a>    <span class="k">USE </span><span class="n">class_cell</span>
<a name="ln-10"></a>    <span class="k">USE </span><span class="n">class_connectivity</span>
<a name="ln-11"></a>    <span class="k">USE </span><span class="n">class_face</span>
<a name="ln-12"></a>    <span class="k">USE </span><span class="n">class_vector</span>
<a name="ln-13"></a>    <span class="k">USE </span><span class="n">class_keytable</span>
<a name="ln-14"></a>    <span class="k">USE </span><span class="n">class_surface</span>
<a name="ln-15"></a>    <span class="k">USE </span><span class="n">class_vertex</span>
<a name="ln-16"></a>    <span class="k">IMPLICIT NONE</span>
<a name="ln-17"></a>
<a name="ln-18"></a><span class="k">CONTAINS</span>
<a name="ln-19"></a>
<a name="ln-20"></a>    <span class="c">! ----- Constructors -----</span>
<a name="ln-21"></a>
<a name="ln-22"></a>    <span class="k">MODULE PROCEDURE </span><span class="n">create_mesh</span>
<a name="ln-23"></a>        <span class="c">!! Global constructor</span>
<a name="ln-24"></a>        <span class="k">USE </span><span class="n">tools_mesh</span><span class="p">,</span>          <span class="n">ONLY</span> <span class="p">:</span> <span class="n">rd_inp_mesh</span><span class="p">,</span> <span class="n">rd_gambit_mesh</span><span class="p">,</span> <span class="n">rd_cgns_mesh</span><span class="p">,</span> <span class="n">cmp_mesh_c2c</span><span class="p">,</span> <span class="n">cmp_mesh_desc</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-25"></a>            <span class="p">&amp;</span>                           <span class="n">cmp_mesh_f2b</span><span class="p">,</span> <span class="n">cmp_mesh_f2f</span><span class="p">,</span> <span class="n">cmp_mesh_part</span><span class="p">,</span> <span class="n">cmp_mesh_renum</span><span class="p">,</span> <span class="n">cmp_mesh_v2b</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-26"></a>            <span class="p">&amp;</span>                           <span class="n">cmp_mesh_v2ve</span><span class="p">,</span> <span class="n">cmp_moving_surf</span><span class="p">,</span> <span class="n">supplement_v2c</span><span class="p">,</span> <span class="n">supplement_v2f</span>
<a name="ln-27"></a>        <span class="k">USE </span><span class="n">tools_mesh_basics</span><span class="p">,</span>   <span class="n">ONLY</span> <span class="p">:</span> <span class="n">geom_face</span><span class="p">,</span> <span class="n">geom_cell</span><span class="p">,</span> <span class="n">geom_diff</span>
<a name="ln-28"></a>        <span class="k">USE </span><span class="n">tools_output_basics</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">wr_mtx_pattern</span>
<a name="ln-29"></a>        <span class="k">USE </span><span class="n">class_least_squares</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">set_least_squares</span>
<a name="ln-30"></a>
<a name="ln-31"></a>        <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">mtx_pat</span>
<a name="ln-32"></a>        <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">icontxt</span><span class="p">,</span> <span class="n">mypnum</span><span class="p">,</span> <span class="n">nprocs</span>
<a name="ln-33"></a>        <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">irenum</span><span class="p">,</span> <span class="n">ipart</span><span class="p">,</span> <span class="n">nswpref</span>
<a name="ln-34"></a>        <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">nverts</span><span class="p">,</span> <span class="n">nfaces</span><span class="p">,</span> <span class="n">ncells</span>
<a name="ln-35"></a>        <span class="kt">REAL</span><span class="p">(</span><span class="n">psb_dpk_</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">scale</span>
<a name="ln-36"></a><span class="nb">        </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">nlen</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mesh_file</span>
<a name="ln-37"></a>
<a name="ln-38"></a>        <span class="n">icontxt</span> <span class="o">=</span> <span class="n">icontxt_</span><span class="p">()</span>
<a name="ln-39"></a>        <span class="n">mypnum</span> <span class="o">=</span> <span class="n">mypnum_</span><span class="p">()</span>
<a name="ln-40"></a>        <span class="n">nprocs</span> <span class="o">=</span> <span class="n">nprocs_</span><span class="p">()</span>
<a name="ln-41"></a>
<a name="ln-42"></a>        <span class="c">! Preliminary check</span>
<a name="ln-43"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">set</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-44"></a><span class="k">            WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<a name="ln-45"></a>            <span class="k">CALL </span><span class="n">abort_psblas</span>
<a name="ln-46"></a>        <span class="k">END IF</span>
<a name="ln-47"></a>
<a name="ln-48"></a>        <span class="c">! Reads mesh-related input parameters</span>
<a name="ln-49"></a>        <span class="k">CALL </span><span class="n">rd_inp_mesh</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span><span class="n">sec</span><span class="p">,&amp;</span>
<a name="ln-50"></a>            <span class="p">&amp;</span> <span class="n">mesh_file</span><span class="p">,</span><span class="nb">scale</span><span class="p">,</span><span class="n">irenum</span><span class="p">,</span><span class="n">ipart</span><span class="p">,</span><span class="n">nswpref</span><span class="p">,</span><span class="n">mtx_pat</span><span class="p">)</span>
<a name="ln-51"></a>
<a name="ln-52"></a>        <span class="c">! Imports the mesh on P0 (verts, faces, cells, v2c, v2f, f2c,c2g ...)</span>
<a name="ln-53"></a>        <span class="k">CALL </span><span class="n">import_mesh</span><span class="p">(</span><span class="n">msh</span><span class="p">,</span><span class="n">mesh_file</span><span class="p">)</span>
<a name="ln-54"></a>
<a name="ln-55"></a><span class="cp">#ifdef DEBUGMSH</span>
<a name="ln-56"></a>        <span class="k">CALL </span><span class="n">nemo_mesh_size</span><span class="p">(</span><span class="n">msh</span><span class="p">)</span>
<a name="ln-57"></a><span class="cp">#endif</span>
<a name="ln-58"></a>
<a name="ln-59"></a>        <span class="c">! Applies the scaling factor</span>
<a name="ln-60"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">mypnum</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-61"></a><span class="k">            </span><span class="n">msh</span><span class="p">%</span><span class="n">verts</span> <span class="o">=</span> <span class="nb">scale</span> <span class="o">*</span> <span class="n">msh</span><span class="p">%</span><span class="n">verts</span>
<a name="ln-62"></a>
<a name="ln-63"></a>            <span class="n">nverts</span> <span class="o">=</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">verts</span><span class="p">)</span>
<a name="ln-64"></a>            <span class="n">nfaces</span> <span class="o">=</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">)</span>
<a name="ln-65"></a>            <span class="n">ncells</span> <span class="o">=</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">cells</span><span class="p">)</span>
<a name="ln-66"></a>        <span class="n">ENDIF</span>
<a name="ln-67"></a>
<a name="ln-68"></a><span class="c">!!$ call cmp_mesh_v2v(nverts,msh%v2c,msh%v2v)         ! Computes MESH%V2V</span>
<a name="ln-69"></a>        <span class="k">CALL </span><span class="n">cmp_mesh_v2ve</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">ncd</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">v2f</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">v2v</span><span class="p">)</span>          <span class="c">!</span>
<a name="ln-70"></a>        <span class="k">CALL </span><span class="n">cmp_mesh_f2f</span><span class="p">(</span><span class="n">nfaces</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">f2c</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">f2f</span><span class="p">)</span>            <span class="c">! Computes MESH%F2F</span>
<a name="ln-71"></a>        <span class="k">CALL </span><span class="n">cmp_mesh_c2c</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">f2c</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">c2c</span><span class="p">)</span>         <span class="c">! Computes MESH%C2C</span>
<a name="ln-72"></a>        <span class="k">CALL </span><span class="n">cmp_mesh_v2b</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">v2f</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">nbc</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">v2b</span><span class="p">)</span> <span class="c">! Computes MESH%V2B</span>
<a name="ln-73"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">mypnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;()&#39;</span><span class="p">)</span>
<a name="ln-74"></a>
<a name="ln-75"></a>        <span class="c">! REMARK: CMP_MESH_V2B must be called BEFORE the G2L_MESH!</span>
<a name="ln-76"></a>
<a name="ln-77"></a><span class="cp">#ifdef DEBUGMSH</span>
<a name="ln-78"></a>        <span class="k">CALL </span><span class="n">nemo_mesh_size</span><span class="p">(</span><span class="n">msh</span><span class="p">)</span>
<a name="ln-79"></a><span class="cp">#endif</span>
<a name="ln-80"></a>
<a name="ln-81"></a>        <span class="c">! Dump mesh-related sparsity pattern before renumbering</span>
<a name="ln-82"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">mtx_pat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-83"></a><span class="k">            CALL </span><span class="n">wr_mtx_pattern</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">c2c</span><span class="p">,</span><span class="s1">&#39;pattern_cell_1.mtx&#39;</span><span class="p">)</span>
<a name="ln-84"></a><span class="c">!!$       call wr_mtx_pattern(msh%v2v,&#39;pattern_vert_1.mtx&#39;)</span>
<a name="ln-85"></a>        <span class="k">END IF</span>
<a name="ln-86"></a>
<a name="ln-87"></a>        <span class="c">! Computes and applies matrix renumbering</span>
<a name="ln-88"></a>        <span class="k">CALL </span><span class="n">cmp_mesh_renum</span><span class="p">(</span><span class="n">irenum</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">cells</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">c2c</span><span class="p">,&amp;</span>
<a name="ln-89"></a>            <span class="p">&amp;</span> <span class="n">msh</span><span class="p">%</span><span class="n">f2c</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">v2c</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">c2g</span><span class="p">)</span>
<a name="ln-90"></a>
<a name="ln-91"></a>        <span class="c">! Dumps mesh-related sparsity pattern after renumbering</span>
<a name="ln-92"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">mtx_pat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">irenum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-93"></a><span class="k">            CALL </span><span class="n">wr_mtx_pattern</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">c2c</span><span class="p">,</span><span class="s1">&#39;pattern_cell_2.mtx&#39;</span><span class="p">)</span>
<a name="ln-94"></a><span class="c">!!$       call wr_mtx_pattern(msh%v2v,&#39;pattern_vert_2.mtx&#39;)</span>
<a name="ln-95"></a>        <span class="k">END IF</span>
<a name="ln-96"></a>
<a name="ln-97"></a>        <span class="c">! Detects conceptual surfaces, needed for surface-constrained</span>
<a name="ln-98"></a>        <span class="c">! vertex motion. Conceptual surfaces cannot exist in 2d.</span>
<a name="ln-99"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">ncd</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-100"></a><span class="k">            CALL </span><span class="n">cmp_moving_surf</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">nbc</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">v2b</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">verts</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-101"></a><span class="c">!!!   to be done bcast_surf</span>
<a name="ln-102"></a>        <span class="n">ENDIF</span>
<a name="ln-103"></a>
<a name="ln-104"></a>        <span class="c">! Calculates the partitioning according to IPART value</span>
<a name="ln-105"></a>        <span class="k">CALL </span><span class="n">cmp_mesh_part</span><span class="p">(</span><span class="n">ipart</span><span class="p">,</span><span class="n">nswpref</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">c2c</span><span class="p">)</span>
<a name="ln-106"></a>
<a name="ln-107"></a>        <span class="c">! Allocates and assemblies the MSH%DESC descriptor</span>
<a name="ln-108"></a>        <span class="k">CALL </span><span class="n">cmp_mesh_desc</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">v2v</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">v2c</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">f2f</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">f2c</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">c2c</span><span class="p">,&amp;</span>
<a name="ln-109"></a>            <span class="p">&amp;</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_v</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_f</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_c</span><span class="p">)</span>
<a name="ln-110"></a>
<a name="ln-111"></a>
<a name="ln-112"></a>        <span class="c">! Store supplemental connectivity info for smoothing the mesh</span>
<a name="ln-113"></a>        <span class="k">CALL </span><span class="n">supplement_v2c</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">v2c</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_v</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">ov2c_sup</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">c2ov_sup</span><span class="p">)</span>
<a name="ln-114"></a>        <span class="k">CALL </span><span class="n">bcast_face</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">)</span>
<a name="ln-115"></a>        <span class="k">CALL </span><span class="n">supplement_v2f</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">v2f</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">desc_v</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">ov2f_sup</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">f2ov_sup</span><span class="p">)</span>
<a name="ln-116"></a>
<a name="ln-117"></a><span class="cp">#ifdef DEBUGMSH</span>
<a name="ln-118"></a>        <span class="k">CALL  </span><span class="n">nemo_mesh_size</span><span class="p">(</span><span class="n">msh</span><span class="p">)</span>
<a name="ln-119"></a>
<a name="ln-120"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">mypnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CALL </span><span class="n">pr_mesh_size</span><span class="p">(</span><span class="n">msh</span><span class="p">)</span>
<a name="ln-121"></a><span class="cp">#endif</span>
<a name="ln-122"></a>
<a name="ln-123"></a>        <span class="c">! ----- GLOBAL 2 LOCAL REALLCATION ----</span>
<a name="ln-124"></a>        <span class="k">CALL </span><span class="n">g2l_mesh</span><span class="p">(</span><span class="n">msh</span><span class="p">)</span>
<a name="ln-125"></a>
<a name="ln-126"></a><span class="cp">#ifdef DEBUGMSH</span>
<a name="ln-127"></a>        <span class="k">CALL  </span><span class="n">nemo_mesh_size</span><span class="p">(</span><span class="n">msh</span><span class="p">)</span>
<a name="ln-128"></a>
<a name="ln-129"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">mypnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CALL </span><span class="n">pr_mesh_size</span><span class="p">(</span><span class="n">msh</span><span class="p">)</span>
<a name="ln-130"></a><span class="cp">#endif</span>
<a name="ln-131"></a>
<a name="ln-132"></a>        <span class="c">! ----- From here on data are LOCAL -----</span>
<a name="ln-133"></a>
<a name="ln-134"></a>        <span class="k">CALL </span><span class="n">cmp_mesh_f2b</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">nbc</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">f2b</span><span class="p">)</span> <span class="c">! Computes MESH%F2B</span>
<a name="ln-135"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">mypnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;()&#39;</span><span class="p">)</span>
<a name="ln-136"></a>
<a name="ln-137"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">mypnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-138"></a><span class="k">            WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Computing mesh metrics&#39;</span>
<a name="ln-139"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-140"></a>        <span class="k">END IF</span>
<a name="ln-141"></a>
<a name="ln-142"></a><span class="k">        CALL </span><span class="n">sw_geo</span><span class="p">%</span><span class="n">tic</span><span class="p">()</span>
<a name="ln-143"></a>
<a name="ln-144"></a>        <span class="c">! Computes face-related metrics members MSH%FACE_CNTR, MSH%AF, MSH%AREA</span>
<a name="ln-145"></a>        <span class="k">CALL </span><span class="n">geom_face</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">verts</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">v2f</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">ncd</span><span class="p">,&amp;</span>
<a name="ln-146"></a>            <span class="p">&amp;</span> <span class="n">msh</span><span class="p">%</span><span class="n">face_cntr</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">af</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">area</span><span class="p">)</span>
<a name="ln-147"></a>
<a name="ln-148"></a>        <span class="c">! Computes cell-related metrics members MSH%CELL_CNTR, MSH%VOL</span>
<a name="ln-149"></a>        <span class="k">CALL </span><span class="n">geom_cell</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">verts</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">cells</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">v2f</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">v2c</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">f2c</span><span class="p">,&amp;</span>
<a name="ln-150"></a>            <span class="p">&amp;</span> <span class="n">msh</span><span class="p">%</span><span class="n">ncd</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">cell_cntr</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">vol</span><span class="p">)</span>
<a name="ln-151"></a>
<a name="ln-152"></a>        <span class="c">! Computes face-related metrics members MSH%DF, MSH%DIST, MSH%INTERP</span>
<a name="ln-153"></a>        <span class="k">CALL </span><span class="n">geom_diff</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">f2b</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">face_cntr</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">af</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">cell_cntr</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-154"></a>            <span class="p">&amp;</span> <span class="n">msh</span><span class="p">%</span><span class="n">df</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">dist</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">interp</span><span class="p">)</span>
<a name="ln-155"></a>
<a name="ln-156"></a>        <span class="c">! Computes metrics for cell-centered least squares regression</span>
<a name="ln-157"></a>        <span class="k">CALL </span><span class="n">set_least_squares</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">lsr</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">ncd</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_c</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">c2c</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">f2b</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-158"></a>            <span class="p">&amp;</span> <span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">cell_cntr</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">face_cntr</span><span class="p">)</span>
<a name="ln-159"></a>
<a name="ln-160"></a>        <span class="k">CALL </span><span class="n">sw_geo</span><span class="p">%</span><span class="n">toc</span><span class="p">()</span>
<a name="ln-161"></a>
<a name="ln-162"></a>        <span class="c">! Sets MSH%SET logical flag on .true.</span>
<a name="ln-163"></a>        <span class="n">msh</span><span class="p">%</span><span class="n">set</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-164"></a>        <span class="n">msh</span><span class="p">%</span><span class="n">ngp</span> <span class="o">=</span> <span class="n">msh</span><span class="p">%</span><span class="n">c2g</span><span class="p">%</span><span class="n">nel_</span><span class="p">()</span>
<a name="ln-165"></a>
<a name="ln-166"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">mypnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-167"></a><span class="k">            WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span> <span class="s1">&#39;Mesh summary&#39;</span>
<a name="ln-168"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span> <span class="s1">&#39;- meshfile:&#39;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">))</span>
<a name="ln-169"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span> <span class="s1">&#39;- Number of cells:   &#39;</span><span class="p">,</span> <span class="n">ncells</span>
<a name="ln-170"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span> <span class="s1">&#39;- Number of faces:   &#39;</span><span class="p">,</span> <span class="n">nfaces</span>
<a name="ln-171"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span> <span class="s1">&#39;- Number of vertices:&#39;</span><span class="p">,</span> <span class="n">nverts</span>
<a name="ln-172"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span> <span class="s1">&#39;- Number of bc:      &#39;</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">nbc</span>
<a name="ln-173"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span> <span class="s1">&#39;- Number of groups:  &#39;</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">ngp</span>
<a name="ln-174"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-175"></a>        <span class="k">END IF</span>
<a name="ln-176"></a>
<a name="ln-177"></a><span class="mi">100</span>     <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; ERROR! MESH object in CREATE_MESH has been already set&#39;</span><span class="p">)</span>
<a name="ln-178"></a><span class="mi">200</span>     <span class="k">FORMAT</span><span class="p">(</span><span class="mi">1</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
<a name="ln-179"></a><span class="mi">300</span>     <span class="k">FORMAT</span><span class="p">(</span><span class="mi">1</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
<a name="ln-180"></a><span class="mi">400</span>     <span class="k">FORMAT</span><span class="p">(</span><span class="mi">1</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">i8</span><span class="p">)</span>
<a name="ln-181"></a><span class="mi">500</span>     <span class="k">FORMAT</span><span class="p">(</span><span class="mi">1</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">i5</span><span class="p">)</span>
<a name="ln-182"></a>
<a name="ln-183"></a>    <span class="k">END PROCEDURE </span><span class="n">create_mesh</span>
<a name="ln-184"></a>
<a name="ln-185"></a>
<a name="ln-186"></a>    <span class="k">SUBROUTINE </span><span class="n">import_mesh</span><span class="p">(</span><span class="n">msh</span><span class="p">,</span><span class="n">mesh_file</span><span class="p">)</span>
<a name="ln-187"></a>        <span class="k">USE </span><span class="n">tools_mesh</span>
<a name="ln-188"></a>        <span class="k">IMPLICIT NONE</span>
<a name="ln-189"></a>        <span class="c">!</span>
<a name="ln-190"></a>        <span class="k">TYPE</span><span class="p">(</span><span class="n">mesh</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">msh</span>
<a name="ln-191"></a>        <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">mesh_file</span>
<a name="ln-192"></a>        <span class="c">!</span>
<a name="ln-193"></a>        <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">intbuf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-194"></a>        <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">icontxt</span><span class="p">,</span> <span class="n">mypnum</span>
<a name="ln-195"></a>        <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fmt</span>
<a name="ln-196"></a>
<a name="ln-197"></a>
<a name="ln-198"></a>        <span class="n">icontxt</span> <span class="o">=</span> <span class="n">icontxt_</span><span class="p">()</span>
<a name="ln-199"></a>        <span class="n">mypnum</span>  <span class="o">=</span> <span class="n">mypnum_</span><span class="p">()</span>
<a name="ln-200"></a>
<a name="ln-201"></a>        <span class="k">CALL </span><span class="n">sw_msh</span><span class="p">%</span><span class="n">tic</span><span class="p">()</span>
<a name="ln-202"></a>
<a name="ln-203"></a>        <span class="c">! Reads the mesh object on P0...</span>
<a name="ln-204"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">mypnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-205"></a>
<a name="ln-206"></a>            <span class="c">! Sets mesh format</span>
<a name="ln-207"></a>            <span class="n">mesh_file</span> <span class="o">=</span> <span class="nb">ADJUSTR</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">)</span>
<a name="ln-208"></a>            <span class="n">i</span> <span class="o">=</span> <span class="nb">SCAN</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.)</span>
<a name="ln-209"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-210"></a><span class="k">                WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<a name="ln-211"></a>                <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a24,a80)&#39;</span><span class="p">)</span><span class="s1">&#39;Expected to find file: &#39;</span><span class="p">,</span><span class="n">mesh_file</span>
<a name="ln-212"></a>                <span class="k">CALL </span><span class="n">abort_psblas</span>
<a name="ln-213"></a>            <span class="k">END IF</span>
<a name="ln-214"></a><span class="k">            </span><span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-215"></a>            <span class="n">fmt</span> <span class="o">=</span> <span class="n">mesh_file</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="nb">LEN</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">))</span>
<a name="ln-216"></a>
<a name="ln-217"></a>            <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">fmt</span><span class="p">)</span>
<a name="ln-218"></a>            <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;cgns&#39;</span><span class="p">)</span>
<a name="ln-219"></a><span class="cp">#ifdef HAVE_CGNS</span>
<a name="ln-220"></a>                <span class="k">CALL </span><span class="n">rd_cgns_mesh</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">id</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">nbc</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">ncd</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-221"></a>                    <span class="p">&amp;</span> <span class="n">msh</span><span class="p">%</span><span class="n">verts</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">cells</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-222"></a>                    <span class="p">&amp;</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2f</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2c</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">f2c</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">c2g</span><span class="p">)</span>
<a name="ln-223"></a><span class="cp">#else</span>
<a name="ln-224"></a>                <span class="n">ERROR</span> <span class="k">STOP</span> <span class="s2">&quot;MORFEUS built without CNGS support! Unable to continue.&quot;</span>
<a name="ln-225"></a><span class="cp">#endif</span>
<a name="ln-226"></a>            <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span>
<a name="ln-227"></a><span class="cp">#ifdef HAVE_EXODUS</span>
<a name="ln-228"></a>                <span class="k">CALL </span><span class="n">rd_exodus_mesh</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">id</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">nbc</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">ncd</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-229"></a>                    <span class="p">&amp;</span> <span class="n">msh</span><span class="p">%</span><span class="n">verts</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">cells</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-230"></a>                    <span class="p">&amp;</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2f</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2c</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">f2c</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">c2g</span><span class="p">)</span>
<a name="ln-231"></a><span class="cp">#else</span>
<a name="ln-232"></a>                <span class="n">ERROR</span> <span class="k">STOP</span> <span class="s2">&quot;MORFEUS built without exodus support! Unable to continue.&quot;</span>
<a name="ln-233"></a><span class="cp">#endif</span>
<a name="ln-234"></a>            <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;msh&#39;</span><span class="p">)</span>
<a name="ln-235"></a>                <span class="k">CALL </span><span class="n">rd_gmsh_mesh</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">id</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">nbc</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">ncd</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-236"></a>                    <span class="p">&amp;</span> <span class="n">msh</span><span class="p">%</span><span class="n">verts</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">cells</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-237"></a>                    <span class="p">&amp;</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2f</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2c</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">f2c</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">c2g</span><span class="p">)</span>
<a name="ln-238"></a>            <span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;neu&#39;</span><span class="p">)</span>
<a name="ln-239"></a>                <span class="k">CALL </span><span class="n">rd_gambit_mesh</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">id</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">nbc</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">ncd</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-240"></a>                    <span class="p">&amp;</span> <span class="n">msh</span><span class="p">%</span><span class="n">verts</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">cells</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-241"></a>                    <span class="p">&amp;</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2f</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2c</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">f2c</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">c2g</span><span class="p">)</span>
<a name="ln-242"></a>            <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-243"></a>                <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<a name="ln-244"></a>                <span class="k">CALL </span><span class="n">abort_psblas</span>
<a name="ln-245"></a>            <span class="k">END SELECT</span>
<a name="ln-246"></a>
<a name="ln-247"></a><span class="k">        END IF</span>
<a name="ln-248"></a>
<a name="ln-249"></a>        <span class="c">! ... then bcast msh%(id,nbc,ncd)</span>
<a name="ln-250"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">mypnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-251"></a>
<a name="ln-252"></a><span class="k">            CALL </span><span class="n">psb_bcast</span><span class="p">(</span><span class="n">icontxt</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">id</span><span class="p">)</span>
<a name="ln-253"></a>
<a name="ln-254"></a>            <span class="n">intbuf</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">msh</span><span class="p">%</span><span class="n">nbc</span>
<a name="ln-255"></a>            <span class="n">intbuf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">msh</span><span class="p">%</span><span class="n">ncd</span>
<a name="ln-256"></a>            <span class="k">CALL </span><span class="n">psb_bcast</span><span class="p">(</span><span class="n">icontxt</span><span class="p">,</span><span class="n">intbuf</span><span class="p">)</span>
<a name="ln-257"></a>        <span class="k">ELSE</span>
<a name="ln-258"></a><span class="k">            CALL </span><span class="n">psb_bcast</span><span class="p">(</span><span class="n">icontxt</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">id</span><span class="p">)</span>
<a name="ln-259"></a>
<a name="ln-260"></a>            <span class="k">CALL </span><span class="n">psb_bcast</span><span class="p">(</span><span class="n">icontxt</span><span class="p">,</span><span class="n">intbuf</span><span class="p">)</span>
<a name="ln-261"></a>            <span class="n">msh</span><span class="p">%</span><span class="n">nbc</span> <span class="o">=</span> <span class="n">intbuf</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-262"></a>            <span class="n">msh</span><span class="p">%</span><span class="n">ncd</span> <span class="o">=</span> <span class="n">intbuf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-263"></a>        <span class="k">END IF</span>
<a name="ln-264"></a>
<a name="ln-265"></a><span class="k">        CALL </span><span class="n">sw_msh</span><span class="p">%</span><span class="n">toc</span><span class="p">()</span>
<a name="ln-266"></a>
<a name="ln-267"></a><span class="mi">100</span>     <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;ERROR! Unsupported mesh filename in IMPORT_MESH&#39;</span><span class="p">)</span>
<a name="ln-268"></a><span class="mi">200</span>     <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39;ERROR! Unsupported mesh format in IMPORT_MESH&#39;</span><span class="p">)</span>
<a name="ln-269"></a>
<a name="ln-270"></a>    <span class="k">END SUBROUTINE </span><span class="n">import_mesh</span>
<a name="ln-271"></a>
<a name="ln-272"></a>    <span class="c">! ----- Global To Local -----</span>
<a name="ln-273"></a>
<a name="ln-274"></a>    <span class="k">SUBROUTINE </span><span class="n">g2l_mesh</span><span class="p">(</span><span class="n">msh</span><span class="p">)</span>
<a name="ln-275"></a>        <span class="k">IMPLICIT NONE</span>
<a name="ln-276"></a>        <span class="c">!!</span>
<a name="ln-277"></a>        <span class="k">TYPE</span><span class="p">(</span><span class="n">mesh</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">msh</span>
<a name="ln-278"></a>
<a name="ln-279"></a>        <span class="k">CALL </span><span class="n">sw_g2l</span><span class="p">%</span><span class="n">tic</span><span class="p">()</span>
<a name="ln-280"></a>
<a name="ln-281"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">mypnum_</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-282"></a><span class="k">            WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Global to local reallocation of MESH object&#39;</span>
<a name="ln-283"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-284"></a>        <span class="k">END IF</span>
<a name="ln-285"></a>
<a name="ln-286"></a><span class="k">        CALL </span><span class="n">g2l_conn</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">v2f</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_v</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_f</span><span class="p">)</span>    <span class="c">! Reallocates MSH%V2F</span>
<a name="ln-287"></a>        <span class="k">CALL </span><span class="n">g2l_face</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_f</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_c</span><span class="p">)</span>  <span class="c">! Reallocates MSH%FACES</span>
<a name="ln-288"></a>        <span class="k">CALL </span><span class="n">bcast_cell</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">cells</span><span class="p">)</span>                      <span class="c">! Broadcast   MSH%CELLS</span>
<a name="ln-289"></a>        <span class="k">CALL </span><span class="n">g2l_cell</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">cells</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_c</span><span class="p">)</span>             <span class="c">! Reallocates MSH%CELLS</span>
<a name="ln-290"></a>        <span class="k">CALL </span><span class="n">bcast_vertex</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">verts</span><span class="p">)</span>                    <span class="c">! Broadcast   MSH%VERTS</span>
<a name="ln-291"></a>        <span class="k">CALL </span><span class="n">g2l_vertex</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">verts</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_v</span><span class="p">)</span>           <span class="c">! Reallocates MSH%VERTS</span>
<a name="ln-292"></a>
<a name="ln-293"></a>        <span class="k">CALL </span><span class="n">g2l_conn</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">v2c</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_v</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_c</span><span class="p">)</span>    <span class="c">! Reallocates MSH%V2C</span>
<a name="ln-294"></a>        <span class="k">CALL </span><span class="n">bcast_conn</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">c2g</span><span class="p">)</span>                        <span class="c">! Broadcast   MSH%C2G</span>
<a name="ln-295"></a>        <span class="k">CALL </span><span class="n">g2l_conn</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">c2g</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_c</span><span class="p">)</span>               <span class="c">! Reallocates MSH%C2G</span>
<a name="ln-296"></a>        <span class="c">!</span>
<a name="ln-297"></a>
<a name="ln-298"></a>        <span class="k">CALL </span><span class="n">bcast_conn</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">v2b</span><span class="p">)</span>                        <span class="c">! Broadcast   MSH%V2B</span>
<a name="ln-299"></a>        <span class="k">CALL </span><span class="n">g2l_conn</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">v2b</span><span class="p">,</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_v</span><span class="p">)</span>               <span class="c">! Reallocates MSH%V2B</span>
<a name="ln-300"></a>
<a name="ln-301"></a>        <span class="k">CALL </span><span class="n">sw_g2l</span><span class="p">%</span><span class="n">toc</span><span class="p">()</span>
<a name="ln-302"></a>
<a name="ln-303"></a>    <span class="k">END SUBROUTINE </span><span class="n">g2l_mesh</span>
<a name="ln-304"></a>
<a name="ln-305"></a>    <span class="k">MODULE PROCEDURE </span><span class="n">free_mesh</span>
<a name="ln-306"></a>    <span class="c">!! ----- Destructor -----</span>
<a name="ln-307"></a>        <span class="k">USE </span><span class="n">psb_base_mod</span>
<a name="ln-308"></a>        <span class="k">USE </span><span class="n">class_least_squares</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">free_least_squares</span>
<a name="ln-309"></a>        <span class="k">IMPLICIT NONE</span>
<a name="ln-310"></a>        <span class="c">!</span>
<a name="ln-311"></a>        <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">err_act</span><span class="p">,</span> <span class="n">icontxt</span><span class="p">,</span> <span class="n">info</span>
<a name="ln-312"></a>        <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ib</span>
<a name="ln-313"></a>
<a name="ln-314"></a>        <span class="c">! Sets error handling for PSBLAS-2 routines</span>
<a name="ln-315"></a>        <span class="n">info</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-316"></a>        <span class="k">CALL </span><span class="n">psb_erractionsave</span><span class="p">(</span><span class="n">err_act</span><span class="p">)</span>
<a name="ln-317"></a>
<a name="ln-318"></a>        <span class="n">icontxt</span> <span class="o">=</span> <span class="n">icontxt_</span><span class="p">()</span>
<a name="ln-319"></a>
<a name="ln-320"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">mypnum_</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Deallocating mesh object&#39;</span>
<a name="ln-321"></a>
<a name="ln-322"></a>        <span class="k">CALL </span><span class="n">free_conn</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">v2c</span><span class="p">)</span>
<a name="ln-323"></a>        <span class="k">CALL </span><span class="n">free_conn</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">v2f</span><span class="p">)</span>
<a name="ln-324"></a>        <span class="k">CALL </span><span class="n">free_conn</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">f2c</span><span class="p">)</span>
<a name="ln-325"></a>        <span class="k">CALL </span><span class="n">free_conn</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">c2g</span><span class="p">)</span>
<a name="ln-326"></a>        <span class="c">!</span>
<a name="ln-327"></a>        <span class="k">CALL </span><span class="n">free_conn</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">v2v</span><span class="p">)</span>
<a name="ln-328"></a>        <span class="k">CALL </span><span class="n">free_conn</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">f2f</span><span class="p">)</span>
<a name="ln-329"></a>        <span class="k">CALL </span><span class="n">free_conn</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">c2c</span><span class="p">)</span>
<a name="ln-330"></a>        <span class="c">!</span>
<a name="ln-331"></a>        <span class="k">CALL </span><span class="n">free_conn</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">v2b</span><span class="p">)</span>
<a name="ln-332"></a>        <span class="k">CALL </span><span class="n">free_conn</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">f2b</span><span class="p">)</span>
<a name="ln-333"></a>
<a name="ln-334"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">surf</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-335"></a><span class="k">            DO </span><span class="n">ib</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">nbc</span>
<a name="ln-336"></a>                <span class="k">CALL </span><span class="n">msh</span><span class="p">%</span><span class="n">surf</span><span class="p">(</span><span class="n">ib</span><span class="p">)%</span><span class="n">free_surface</span><span class="p">()</span>
<a name="ln-337"></a>            <span class="k">END DO</span>
<a name="ln-338"></a><span class="k">            DEALLOCATE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">surf</span><span class="p">)</span>
<a name="ln-339"></a>        <span class="n">ENDIF</span>
<a name="ln-340"></a>
<a name="ln-341"></a>        <span class="c">! these supplemental info keytables are only filled for</span>
<a name="ln-342"></a>        <span class="c">! parallel runs, so check before freeing</span>
<a name="ln-343"></a>
<a name="ln-344"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="n">msh</span><span class="p">%</span><span class="n">ov2c_sup</span><span class="p">%</span><span class="n">exists</span><span class="p">()</span> <span class="p">)</span> <span class="k">CALL </span><span class="n">msh</span><span class="p">%</span><span class="n">ov2c_sup</span><span class="p">%</span><span class="n">free_keytable</span><span class="p">()</span>
<a name="ln-345"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="n">msh</span><span class="p">%</span><span class="n">c2ov_sup</span><span class="p">%</span><span class="n">exists</span><span class="p">()</span> <span class="p">)</span> <span class="k">CALL </span><span class="n">msh</span><span class="p">%</span><span class="n">c2ov_sup</span><span class="p">%</span><span class="n">free_keytable</span><span class="p">()</span>
<a name="ln-346"></a>
<a name="ln-347"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="n">msh</span><span class="p">%</span><span class="n">ov2f_sup</span><span class="p">%</span><span class="n">exists</span><span class="p">()</span> <span class="p">)</span> <span class="k">CALL </span><span class="n">msh</span><span class="p">%</span><span class="n">ov2f_sup</span><span class="p">%</span><span class="n">free_keytable</span><span class="p">()</span>
<a name="ln-348"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="n">msh</span><span class="p">%</span><span class="n">f2ov_sup</span><span class="p">%</span><span class="n">exists</span><span class="p">()</span> <span class="p">)</span> <span class="k">CALL </span><span class="n">msh</span><span class="p">%</span><span class="n">f2ov_sup</span><span class="p">%</span><span class="n">free_keytable</span><span class="p">()</span>
<a name="ln-349"></a>
<a name="ln-350"></a>        <span class="k">CALL </span><span class="n">free_vertex</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">verts</span><span class="p">)</span>
<a name="ln-351"></a>        <span class="k">CALL </span><span class="n">free_face</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">)</span>
<a name="ln-352"></a>        <span class="k">CALL </span><span class="n">free_cell</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">cells</span><span class="p">)</span>
<a name="ln-353"></a>
<a name="ln-354"></a>        <span class="k">CALL </span><span class="n">psb_cdfree</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_v</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-355"></a>        <span class="k">CALL </span><span class="n">psb_check_error</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="s1">&#39;free_mesh%desc_v&#39;</span><span class="p">,</span><span class="s1">&#39;psb_cdfree&#39;</span><span class="p">,</span><span class="n">icontxt</span><span class="p">)</span>
<a name="ln-356"></a>        <span class="c">!</span>
<a name="ln-357"></a>        <span class="k">CALL </span><span class="n">psb_cdfree</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_f</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-358"></a>        <span class="k">CALL </span><span class="n">psb_check_error</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="s1">&#39;free_mesh%desc_f&#39;</span><span class="p">,</span><span class="s1">&#39;psb_cdfree&#39;</span><span class="p">,</span><span class="n">icontxt</span><span class="p">)</span>
<a name="ln-359"></a>        <span class="c">!</span>
<a name="ln-360"></a>        <span class="k">CALL </span><span class="n">psb_cdfree</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_c</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<a name="ln-361"></a>        <span class="k">CALL </span><span class="n">psb_check_error</span><span class="p">(</span><span class="n">info</span><span class="p">,</span><span class="s1">&#39;free_mesh%desc_c&#39;</span><span class="p">,</span><span class="s1">&#39;psb_cdfree&#39;</span><span class="p">,</span><span class="n">icontxt</span><span class="p">)</span>
<a name="ln-362"></a>
<a name="ln-363"></a>        <span class="c">! Face-related metrics</span>
<a name="ln-364"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">area</span><span class="p">)</span>
<a name="ln-365"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">dist</span><span class="p">)</span>
<a name="ln-366"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">interp</span><span class="p">)</span>
<a name="ln-367"></a>        <span class="k">CALL </span><span class="n">free_vector</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">face_cntr</span><span class="p">)</span>
<a name="ln-368"></a>        <span class="k">CALL </span><span class="n">free_vector</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">af</span><span class="p">)</span>
<a name="ln-369"></a>        <span class="k">CALL </span><span class="n">free_vector</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">df</span><span class="p">)</span>
<a name="ln-370"></a>
<a name="ln-371"></a>        <span class="c">! Cell-related metrics</span>
<a name="ln-372"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">vol</span><span class="p">)</span>
<a name="ln-373"></a>        <span class="k">CALL </span><span class="n">free_vector</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">cell_cntr</span><span class="p">)</span>
<a name="ln-374"></a>
<a name="ln-375"></a>        <span class="c">! Least Squares metrics</span>
<a name="ln-376"></a>        <span class="k">CALL </span><span class="n">free_least_squares</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">lsr</span><span class="p">)</span>
<a name="ln-377"></a>
<a name="ln-378"></a>        <span class="n">msh</span><span class="p">%</span><span class="n">set</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-379"></a>
<a name="ln-380"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">mypnum_</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-381"></a>
<a name="ln-382"></a>        <span class="c">! ----- Normal Termination -----</span>
<a name="ln-383"></a>        <span class="k">CALL </span><span class="n">psb_erractionrestore</span><span class="p">(</span><span class="n">err_act</span><span class="p">)</span>
<a name="ln-384"></a>
<a name="ln-385"></a>    <span class="k">END PROCEDURE </span><span class="n">free_mesh</span>
<a name="ln-386"></a>
<a name="ln-387"></a>    <span class="k">MODULE PROCEDURE </span><span class="n">check_mesh_consistency</span>
<a name="ln-388"></a>        <span class="k">IMPLICIT NONE</span>
<a name="ln-389"></a>        <span class="c">!! Checks the consistency of two meshes: MSH1 and MSH2</span>
<a name="ln-390"></a>
<a name="ln-391"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="nb">ASSOCIATED</span><span class="p">(</span><span class="n">msh1</span><span class="p">,</span> <span class="n">msh2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-392"></a><span class="k">            WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="k">WHERE</span><span class="p">)</span>
<a name="ln-393"></a>            <span class="k">CALL </span><span class="n">abort_psblas</span>
<a name="ln-394"></a>        <span class="k">END IF</span>
<a name="ln-395"></a>
<a name="ln-396"></a><span class="mi">100</span>     <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; ERROR! In &#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span><span class="s1">&#39;: mesh pointers are not consistent&#39;</span><span class="p">)</span>
<a name="ln-397"></a>
<a name="ln-398"></a>    <span class="k">END PROCEDURE </span><span class="n">check_mesh_consistency</span>
<a name="ln-399"></a>
<a name="ln-400"></a>    <span class="c">! ----- Check Operations -----</span>
<a name="ln-401"></a>
<a name="ln-402"></a>    <span class="k">MODULE PROCEDURE </span><span class="n">check_mesh_unused_el</span>
<a name="ln-403"></a>        <span class="k">IMPLICIT NONE</span>
<a name="ln-404"></a>        <span class="c">! Scans through numerous connectivities, ensuring that in each one,</span>
<a name="ln-405"></a>        <span class="c">! all faces &amp; cells are referenced at least once.</span>
<a name="ln-406"></a>
<a name="ln-407"></a>        <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">mypnum</span>
<a name="ln-408"></a>        <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">failures</span>
<a name="ln-409"></a>
<a name="ln-410"></a>        <span class="n">mypnum</span> <span class="o">=</span> <span class="n">mypnum_</span><span class="p">()</span>
<a name="ln-411"></a>
<a name="ln-412"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">mypnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39; Checking C2C connectivity...&#39;</span>
<a name="ln-413"></a>        <span class="n">failures</span> <span class="o">=</span> <span class="n">msh</span><span class="p">%</span><span class="n">c2c</span><span class="p">%</span><span class="n">unused_elements</span><span class="p">()</span>
<a name="ln-414"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">failures</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-415"></a><span class="k">            WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="n">failures</span><span class="p">,</span> <span class="s1">&#39;cells&#39;</span><span class="p">,</span> <span class="s1">&#39;MSH%C2C&#39;</span><span class="p">,</span> <span class="n">mypnum</span>
<a name="ln-416"></a>            <span class="k">CALL </span><span class="n">abort_psblas</span>
<a name="ln-417"></a>        <span class="k">END IF</span>
<a name="ln-418"></a>
<a name="ln-419"></a><span class="k">        IF</span><span class="p">(</span><span class="n">mypnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39; Checking F2C connectivity...&#39;</span>
<a name="ln-420"></a>        <span class="n">failures</span> <span class="o">=</span> <span class="n">msh</span><span class="p">%</span><span class="n">f2c</span><span class="p">%</span><span class="n">unused_elements</span><span class="p">()</span>
<a name="ln-421"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">failures</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-422"></a><span class="k">            WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="n">failures</span><span class="p">,</span> <span class="s1">&#39;faces&#39;</span><span class="p">,</span> <span class="s1">&#39;MSH%F2C&#39;</span><span class="p">,</span> <span class="n">mypnum</span>
<a name="ln-423"></a>            <span class="k">CALL </span><span class="n">abort_psblas</span>
<a name="ln-424"></a>        <span class="k">END IF</span>
<a name="ln-425"></a>
<a name="ln-426"></a><span class="k">        IF</span><span class="p">(</span><span class="n">mypnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39; Checking V2C connectivity...&#39;</span>
<a name="ln-427"></a>        <span class="n">failures</span> <span class="o">=</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2c</span><span class="p">%</span><span class="n">unused_elements</span><span class="p">()</span>
<a name="ln-428"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">failures</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-429"></a><span class="k">            WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="n">failures</span><span class="p">,</span> <span class="s1">&#39;vertices&#39;</span><span class="p">,</span> <span class="s1">&#39;MSH%V2C&#39;</span><span class="p">,</span> <span class="n">mypnum</span>
<a name="ln-430"></a>            <span class="k">CALL </span><span class="n">abort_psblas</span>
<a name="ln-431"></a>        <span class="k">END IF</span>
<a name="ln-432"></a>
<a name="ln-433"></a><span class="k">        IF</span><span class="p">(</span><span class="n">mypnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39; Checking V2F connectivity...&#39;</span>
<a name="ln-434"></a>        <span class="n">failures</span> <span class="o">=</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2f</span><span class="p">%</span><span class="n">unused_elements</span><span class="p">()</span>
<a name="ln-435"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">failures</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-436"></a><span class="k">            WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="n">failures</span><span class="p">,</span> <span class="s1">&#39;vertices&#39;</span><span class="p">,</span> <span class="s1">&#39;MSH%V2F&#39;</span><span class="p">,</span> <span class="n">mypnum</span>
<a name="ln-437"></a>            <span class="k">CALL </span><span class="n">abort_psblas</span>
<a name="ln-438"></a>        <span class="k">END IF</span>
<a name="ln-439"></a>
<a name="ln-440"></a><span class="mi">100</span>     <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; ERROR! &#39;</span><span class="p">,</span><span class="n">i3</span><span class="p">,</span><span class="s1">&#39; unused &#39;</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="s1">&#39; in &#39;</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="s1">&#39; connectivity detected&#39;</span><span class="p">,&amp;</span>
<a name="ln-441"></a>            <span class="p">&amp;</span> <span class="s1">&#39; on process &#39;</span><span class="p">,</span><span class="n">i2</span><span class="p">)</span>
<a name="ln-442"></a>
<a name="ln-443"></a>    <span class="k">END PROCEDURE </span><span class="n">check_mesh_unused_el</span>
<a name="ln-444"></a>
<a name="ln-445"></a>    <span class="k">SUBROUTINE </span><span class="n">nemo_mesh_size</span><span class="p">(</span><span class="n">msh</span><span class="p">)</span>
<a name="ln-446"></a>        <span class="k">IMPLICIT NONE</span>
<a name="ln-447"></a><span class="k">        TYPE</span><span class="p">(</span><span class="n">mesh</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">msh</span>
<a name="ln-448"></a>        <span class="kt">INTEGER</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">nemo_int_long_</span><span class="p">)</span>   <span class="kd">::</span><span class="n">isz</span>
<a name="ln-449"></a>        <span class="kt">REAL</span><span class="kd">::</span> <span class="n">sz</span><span class="p">,</span><span class="n">sz1</span>
<a name="ln-450"></a>        <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">icontxt</span><span class="p">,</span> <span class="n">mypnum</span><span class="p">,</span> <span class="n">nprocs</span><span class="p">,</span><span class="n">ip</span>
<a name="ln-451"></a>        <span class="n">icontxt</span><span class="o">=</span><span class="n">icontxt_</span><span class="p">()</span>
<a name="ln-452"></a>        <span class="n">mypnum</span> <span class="o">=</span> <span class="n">mypnum_</span><span class="p">()</span>
<a name="ln-453"></a>        <span class="n">nprocs</span> <span class="o">=</span> <span class="n">nprocs_</span><span class="p">()</span>
<a name="ln-454"></a>        <span class="n">isz</span> <span class="o">=</span> <span class="n">msh</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-455"></a>        <span class="n">sz</span><span class="o">=</span><span class="n">isz</span>
<a name="ln-456"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">mypnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-457"></a><span class="k">            WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;()&#39;</span><span class="p">)</span>
<a name="ln-458"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;On process&#39;</span><span class="p">,</span><span class="n">mypnum</span><span class="p">,</span> <span class="s1">&#39;mesh size&#39;</span><span class="p">,</span><span class="n">sz</span>
<a name="ln-459"></a>        <span class="k">END IF</span>
<a name="ln-460"></a><span class="k">        DO </span><span class="n">ip</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nprocs</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-461"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">mypnum</span> <span class="o">==</span> <span class="n">ip</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-462"></a><span class="k">                CALL </span><span class="n">psb_snd</span><span class="p">(</span><span class="n">icontxt</span><span class="p">,</span><span class="n">sz</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-463"></a>            <span class="n">ELSEIF</span><span class="p">(</span><span class="n">mypnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-464"></a><span class="k">                CALL </span><span class="n">psb_rcv</span><span class="p">(</span><span class="n">icontxt</span><span class="p">,</span><span class="n">sz1</span><span class="p">,</span><span class="n">ip</span><span class="p">)</span>
<a name="ln-465"></a>                <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;On process&#39;</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span> <span class="s1">&#39;mesh size&#39;</span><span class="p">,</span> <span class="n">sz1</span>
<a name="ln-466"></a>            <span class="k">END IF</span>
<a name="ln-467"></a><span class="k">        END DO</span>
<a name="ln-468"></a><span class="k">        CALL </span><span class="n">psb_sum</span><span class="p">(</span><span class="n">icontxt</span><span class="p">,</span><span class="n">isz</span><span class="p">)</span>
<a name="ln-469"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">mypnum</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-470"></a><span class="k">            WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Total size of mesh   :&#39;</span><span class="p">,</span><span class="n">isz</span>
<a name="ln-471"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<a name="ln-472"></a>        <span class="n">ENDIF</span>
<a name="ln-473"></a>    <span class="k">END SUBROUTINE </span><span class="n">nemo_mesh_size</span>
<a name="ln-474"></a>
<a name="ln-475"></a>    <span class="k">MODULE PROCEDURE </span><span class="n">nemo_mesh_sizeof</span>
<a name="ln-476"></a>        <span class="k">USE </span><span class="n">psb_base_mod</span>
<a name="ln-477"></a>        <span class="k">IMPLICIT NONE</span>
<a name="ln-478"></a>
<a name="ln-479"></a><span class="k">        </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">nemo_int_long_</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">val</span>
<a name="ln-480"></a>
<a name="ln-481"></a>        <span class="n">val</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">nemo_sizeof_int</span> <span class="o">+</span> <span class="nb">LEN</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">id</span><span class="p">)</span>
<a name="ln-482"></a>        <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2c</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span> <span class="p">&amp;</span>
<a name="ln-483"></a>            <span class="p">&amp;</span> <span class="o">+</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2f</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()&amp;</span>
<a name="ln-484"></a>            <span class="p">&amp;</span> <span class="o">+</span> <span class="n">msh</span><span class="p">%</span><span class="n">f2c</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()&amp;</span>
<a name="ln-485"></a>            <span class="p">&amp;</span> <span class="o">+</span> <span class="n">msh</span><span class="p">%</span><span class="n">c2g</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()&amp;</span>
<a name="ln-486"></a>            <span class="p">&amp;</span> <span class="o">+</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2v</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()&amp;</span>
<a name="ln-487"></a>            <span class="p">&amp;</span> <span class="o">+</span> <span class="n">msh</span><span class="p">%</span><span class="n">f2f</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()&amp;</span>
<a name="ln-488"></a>            <span class="p">&amp;</span> <span class="o">+</span> <span class="n">msh</span><span class="p">%</span><span class="n">c2c</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()&amp;</span>
<a name="ln-489"></a>            <span class="p">&amp;</span> <span class="o">+</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2b</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()&amp;</span>
<a name="ln-490"></a>            <span class="p">&amp;</span> <span class="o">+</span> <span class="n">msh</span><span class="p">%</span><span class="n">f2b</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-491"></a>
<a name="ln-492"></a>        <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="n">msh</span><span class="p">%</span><span class="n">ov2c_sup</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span> <span class="p">&amp;</span>
<a name="ln-493"></a>        <span class="p">&amp;</span> <span class="o">+</span> <span class="n">msh</span><span class="p">%</span><span class="n">c2ov_sup</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span> <span class="p">&amp;</span>
<a name="ln-494"></a>        <span class="p">&amp;</span> <span class="o">+</span> <span class="n">msh</span><span class="p">%</span><span class="n">ov2f_sup</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span> <span class="p">&amp;</span>
<a name="ln-495"></a>        <span class="p">&amp;</span> <span class="o">+</span> <span class="n">msh</span><span class="p">%</span><span class="n">f2ov_sup</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-496"></a>
<a name="ln-497"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">verts</span><span class="p">))&amp;</span>
<a name="ln-498"></a>            <span class="p">&amp;</span> <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">verts</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-499"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">))&amp;</span>
<a name="ln-500"></a>            <span class="p">&amp;</span> <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-501"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">cells</span><span class="p">))&amp;</span>
<a name="ln-502"></a>            <span class="p">&amp;</span> <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">cells</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-503"></a>
<a name="ln-504"></a>        <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="n">psb_sizeof</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_v</span><span class="p">)&amp;</span>
<a name="ln-505"></a>            <span class="p">&amp;</span> <span class="o">+</span> <span class="n">psb_sizeof</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_f</span><span class="p">)&amp;</span>
<a name="ln-506"></a>            <span class="p">&amp;</span> <span class="o">+</span> <span class="n">psb_sizeof</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_c</span><span class="p">)</span>
<a name="ln-507"></a>
<a name="ln-508"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">area</span><span class="p">))&amp;</span>
<a name="ln-509"></a>            <span class="p">&amp;</span> <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="n">nemo_sizeof_dp</span> <span class="o">*</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">area</span><span class="p">)</span>
<a name="ln-510"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">dist</span><span class="p">))&amp;</span>
<a name="ln-511"></a>            <span class="p">&amp;</span> <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="n">nemo_sizeof_dp</span> <span class="o">*</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">dist</span><span class="p">)</span>
<a name="ln-512"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">interp</span><span class="p">))&amp;</span>
<a name="ln-513"></a>            <span class="p">&amp;</span> <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="n">nemo_sizeof_dp</span> <span class="o">*</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">interp</span><span class="p">)</span>
<a name="ln-514"></a>
<a name="ln-515"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">face_cntr</span><span class="p">))&amp;</span>
<a name="ln-516"></a>            <span class="p">&amp;</span> <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">face_cntr</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-517"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">af</span><span class="p">))&amp;</span>
<a name="ln-518"></a>            <span class="p">&amp;</span> <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">af</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-519"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">df</span><span class="p">))&amp;</span>
<a name="ln-520"></a>            <span class="p">&amp;</span> <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">df</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-521"></a>
<a name="ln-522"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">vol</span><span class="p">))&amp;</span>
<a name="ln-523"></a>            <span class="p">&amp;</span> <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="n">nemo_sizeof_dp</span> <span class="o">*</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">vol</span><span class="p">)</span>
<a name="ln-524"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">cell_cntr</span><span class="p">))&amp;</span>
<a name="ln-525"></a>            <span class="p">&amp;</span> <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">cell_cntr</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-526"></a>
<a name="ln-527"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">lsr</span><span class="p">))&amp;</span>
<a name="ln-528"></a>            <span class="p">&amp;</span> <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">lsr</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-529"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">surf</span><span class="p">))&amp;</span>
<a name="ln-530"></a>            <span class="p">&amp;</span> <span class="n">val</span> <span class="o">=</span> <span class="n">val</span> <span class="o">+</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">surf</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-531"></a>
<a name="ln-532"></a>        <span class="n">nemo_mesh_sizeof</span> <span class="o">=</span> <span class="n">val</span>
<a name="ln-533"></a>
<a name="ln-534"></a>    <span class="k">END PROCEDURE </span><span class="n">nemo_mesh_sizeof</span>
<a name="ln-535"></a>
<a name="ln-536"></a>    <span class="k">SUBROUTINE </span><span class="n">pr_mesh_size</span><span class="p">(</span><span class="n">msh</span><span class="p">)</span>
<a name="ln-537"></a>        <span class="k">USE </span><span class="n">psb_base_mod</span>
<a name="ln-538"></a>        <span class="k">IMPLICIT NONE</span>
<a name="ln-539"></a>
<a name="ln-540"></a><span class="k">        TYPE</span><span class="p">(</span><span class="n">mesh</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">msh</span>
<a name="ln-541"></a>
<a name="ln-542"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of v2c: &#39;</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2c</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-543"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of v2f:&#39;</span> <span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2f</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-544"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of f2c:&#39;</span> <span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">f2c</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-545"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of c2g:&#39;</span> <span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">c2g</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-546"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of v2v:&#39;</span> <span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2v</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-547"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of f2f:&#39;</span> <span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">f2f</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-548"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of c2c:&#39;</span> <span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">c2c</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-549"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of v2b:&#39;</span> <span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">v2b</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-550"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of f2b:&#39;</span> <span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">f2b</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-551"></a>
<a name="ln-552"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of v2c_sup:&#39;</span> <span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">ov2c_sup</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-553"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of c2ov_sup:&#39;</span><span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">c2ov_sup</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-554"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of v2f_sup:&#39;</span> <span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">ov2f_sup</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-555"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of f2ov_sup:&#39;</span> <span class="p">,</span> <span class="n">msh</span><span class="p">%</span><span class="n">f2ov_sup</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">()</span>
<a name="ln-556"></a>
<a name="ln-557"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">verts</span><span class="p">))&amp;</span>
<a name="ln-558"></a>            <span class="p">&amp;</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of verts:&#39;</span> <span class="p">,</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">verts</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-559"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">))&amp;</span>
<a name="ln-560"></a>            <span class="p">&amp;</span>  <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of faces:&#39;</span> <span class="p">,</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">faces</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-561"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">cells</span><span class="p">))&amp;</span>
<a name="ln-562"></a>            <span class="p">&amp;</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of cells:&#39;</span> <span class="p">,</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">cells</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-563"></a>
<a name="ln-564"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of desc_v:&#39;</span> <span class="p">,</span> <span class="n">psb_sizeof</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_v</span><span class="p">)</span>
<a name="ln-565"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of desc_f:&#39;</span> <span class="p">,</span> <span class="n">psb_sizeof</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_f</span><span class="p">)</span>
<a name="ln-566"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of desc_c:&#39;</span> <span class="p">,</span> <span class="n">psb_sizeof</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">desc_c</span><span class="p">)</span>
<a name="ln-567"></a>
<a name="ln-568"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">area</span><span class="p">))&amp;</span>
<a name="ln-569"></a>            <span class="p">&amp;</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of msh%area:&#39;</span> <span class="p">,</span> <span class="n">nemo_sizeof_dp</span> <span class="o">*</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">area</span><span class="p">)</span>
<a name="ln-570"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">dist</span><span class="p">))&amp;</span>
<a name="ln-571"></a>            <span class="p">&amp;</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of msh%dist:&#39;</span> <span class="p">,</span> <span class="n">nemo_sizeof_dp</span> <span class="o">*</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">dist</span><span class="p">)</span>
<a name="ln-572"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">interp</span><span class="p">))&amp;</span>
<a name="ln-573"></a>            <span class="p">&amp;</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of mesh&amp;interp:&#39;</span> <span class="p">,</span> <span class="n">nemo_sizeof_dp</span> <span class="o">*</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">interp</span><span class="p">)</span>
<a name="ln-574"></a>
<a name="ln-575"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">face_cntr</span><span class="p">))&amp;</span>
<a name="ln-576"></a>            <span class="p">&amp;</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of msh&amp;face_cntr:&#39;</span> <span class="p">,</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">face_cntr</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-577"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">af</span><span class="p">))&amp;</span>
<a name="ln-578"></a>            <span class="p">&amp;</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of msh%af:&#39;</span> <span class="p">,</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">af</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-579"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">df</span><span class="p">))&amp;</span>
<a name="ln-580"></a>            <span class="p">&amp;</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of msh%df:&#39;</span> <span class="p">,</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">df</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-581"></a>
<a name="ln-582"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">vol</span><span class="p">))&amp;</span>
<a name="ln-583"></a>            <span class="p">&amp;</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of msh%vol:&#39;</span> <span class="p">,</span> <span class="n">nemo_sizeof_dp</span> <span class="o">*</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">vol</span><span class="p">)</span>
<a name="ln-584"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">cell_cntr</span><span class="p">))&amp;</span>
<a name="ln-585"></a>            <span class="p">&amp;</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of msh%cell_cntr:&#39;</span> <span class="p">,</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">cell_cntr</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-586"></a>
<a name="ln-587"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">lsr</span><span class="p">))&amp;</span>
<a name="ln-588"></a>            <span class="p">&amp;</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of msh%lsr:&#39;</span> <span class="p">,</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">lsr</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-589"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">surf</span><span class="p">))&amp;</span>
<a name="ln-590"></a>            <span class="p">&amp;</span> <span class="k">WRITE</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Size of msh%surf:&#39;</span> <span class="p">,</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">msh</span><span class="p">%</span><span class="n">surf</span><span class="p">%</span><span class="n">nemo_sizeof</span><span class="p">())</span>
<a name="ln-591"></a>
<a name="ln-592"></a>    <span class="k">END SUBROUTINE </span><span class="n">pr_mesh_size</span>
<a name="ln-593"></a>
<a name="ln-594"></a><span class="k">END SUBMODULE </span><span class="n">class_mesh_procedures</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2020 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
                                          <br /><small>763bcb5</small></p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2020-02-28 18:29  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> Morfeus Framework was developed by Guide Star Engineering, LLC</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>